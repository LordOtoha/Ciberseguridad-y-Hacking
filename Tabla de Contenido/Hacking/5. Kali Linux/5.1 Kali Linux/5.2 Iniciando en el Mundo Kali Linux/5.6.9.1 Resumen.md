# PERMISOS ESPECIALES Y SEGURIDAD EN LINUX

## ğŸ” SUID â€“ _Set User ID_

**Â¿QuÃ© hace?**  
Permite que un ejecutable se ejecute con los privilegios del **usuario dueÃ±o del archivo**, normalmente root.

**Ejemplo:**

`chmod u+s binario ls -l binario`

Salida:

`-rwsr-xr-x 1 root root binario`

**ğŸ›‘ Riesgo:**  
Un atacante podrÃ­a aprovechar un binario con SUID mal programado para **ejecutar comandos como root** y tomar control total del sistema.

**âœ… SoluciÃ³n:**

1. Localizar binarios con SUID:
    
`find / -perm -4000 -type f 2>/dev/null`

2. Eliminar el SUID si no es necesario:
    
`chmod u-s binario`

---

## ğŸ‘¥ SGID â€“ _Set Group ID_

**Â¿QuÃ© hace?**

- En archivos ejecutables: ejecuta el programa con el **grupo del archivo**.
    
- En directorios: **los archivos heredan el grupo del directorio padre**, Ãºtil para trabajo colaborativo.
    

**Ejemplo:**

`chmod g+s /ruta/carpeta ls -ld /ruta/carpeta`

Salida:

`drwxrwsr-x 2 usuario grupo carpeta`

**ğŸ›‘ Riesgo:**  
Si el directorio tiene SGID y permisos amplios, un atacante puede crear archivos ejecutables que otros usuarios del grupo podrÃ­an ejecutar, facilitando la **elevaciÃ³n de privilegios** o manipulaciÃ³n de archivos.

**âœ… SoluciÃ³n:**

1. Revisar permisos de directorios compartidos:
    

`ls -ld carpeta`

2. Eliminar SGID si no es requerido:
    
`chmod g-s carpeta`

---

## ğŸ“Œ Sticky Bit

**Â¿QuÃ© hace?**  
En directorios compartidos, evita que un usuario **borre o renombre archivos que no le pertenecen**, incluso si tiene permisos de escritura en el directorio.

**Ejemplo:**

`chmod +t /tmp ls -ld /tmp`

Salida:

`drwxrwxrwt 10 root root /tmp`

**ğŸ›‘ Riesgo:**  
Si no estÃ¡ habilitado en directorios como `/tmp`, cualquier usuario podrÃ­a eliminar archivos de otros usuarios, lo cual podrÃ­a usarse para **DoS o sabotaje**.

**âœ… SoluciÃ³n:**

1. Verificar presencia del sticky bit:
    
`ls -ld /tmp`

2. Activarlo si no estÃ¡ presente:
    
`chmod +t /tmp`

---

## ğŸ›¡ `chattr` â€“ Cambiar atributos avanzados

**Â¿QuÃ© hace?**  
Permite establecer atributos como **inmutable** (`+i`), **solo append** (`+a`), y otros que modifican el comportamiento de archivos.

**Ejemplo:**

`chattr +i archivo.conf lsattr archivo.conf`

Salida:

`----i-------- archivo.conf`

**ğŸ›‘ Riesgo:**  
Un atacante con privilegios puede usar `chattr +i` para **impedir que se borren o editen archivos**, incluso por root. TambiÃ©n puede usarse para **ocultar malware persistente**.

**âœ… SoluciÃ³n:**

1. Ver atributos:
    
`lsattr archivo`

2. Eliminar atributos sospechosos:
    
`chattr -i archivo`

---

## ğŸ” `lsattr` â€“ Ver atributos especiales

**Â¿QuÃ© hace?**  
Muestra atributos aplicados con `chattr`. Muy Ãºtil para detectar archivos inmutables o con restricciones especiales.

**Ejemplo:**

`lsattr archivo`

**ğŸ›‘ Riesgo:**  
Si no se inspeccionan los atributos, archivos maliciosos pueden permanecer invisibles a la administraciÃ³n tradicional (inmutables, logs protegidos, etc.).

**âœ… SoluciÃ³n:**

1. Revisar directorios crÃ­ticos regularmente:
    
`lsattr /etc /var /home`

2. Usar `chattr -` para revertir atributos no deseados.
    
---
## ğŸ” NOTA FINAL

Todos estos mecanismos son poderosos para proteger archivos y sistemas **si se aplican bien**. Pero tambiÃ©n pueden ser **armas de doble filo** si se configuran mal o se dejan abiertos en un entorno comprometido.

ğŸ”§ Herramientas para auditar y proteger:

- `find / -perm -4000` (SUID)
    
- `ls -ld` para directorios con SGID o Sticky Bit
    
- `lsattr` para detectar atributos ocultos
    
- RevisiÃ³n de cronjobs, scripts y permisos compartidos